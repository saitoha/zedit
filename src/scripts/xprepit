if [ $# -eq 1 ]
then
	preppy	-DSYSV		\
		-DSYSV4		\
		-DXWINDOWS	\
		-DSCROLLBARS	\
		-DDBG		\
		-DUSE_RCS	\
		-DABORT_DISP	\
		-DOPENDIR	\
		-DHAS_RESIZE	\
		-DXORCURSOR	\
		-DMAILDIR	\
		-DUNIX		\
		-DPIPESH	\
		-DSPELL		\
		-DNUMKEYS	\
		$1
else	
	for file in ada.c bcmds.c bind.c bind2.c bindings.c buff.c 	\
		calc.c comms.c comms1.c cursor.c dbg.c delete.c 	\
		display.c file.c funcs.c getarg.c getfname.c 	\
		global.c help.c kbd.c life.c macro.c make.c	\
		mbuff.c memlog.c modes.c rcs.c reg.c shell.c	\
		spell.c srch.c support.c tags.c term.c termcap.c 	\
		terminfo.c unix.c vars.c vbuff.c window.c cache.c z.c	\
		buff.h cnames.h global.h help.h keys.h term.h vars.h z.h\
		xinit.c xwind.c xpipe.c adascan.c comment.c xpopup.c	\
		xquery.c xscroll.c
	do
		echo "Processing $file"
		preppy	-DSYSV		\
			-DSYSV4		\
			-DXWINDOWS	\
			-DSCROLLBARS	\
			-DDBG		\
			-DUSE_RCS	\
			-DABORT_DISP	\
			-DOPENDIR	\
			-DHAS_RESIZE	\
			-DXORCURSOR	\
			-DMAILDIR	\
			-DUNIX		\
			-DSPELL		\
			-DNUMKEYS	\
			$file >$file.i
	done

	etags -dto tags.tmp *.i
	posttags < tags.tmp | sed 's/\.i//' >tags
	rm tags.tmp *.i

fi

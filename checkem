#!/bin/sh

checkpatch=/lib/modules/`uname -r`/source/scripts/checkpatch.pl

echo "Running sparse..."
for f in *.[ch]; do
    sparse -D__linux__ $f
done

echo "Running checkpatch..."
for f in *.[ch]; do
    [ $f = typedefs.h ] && continue
    [ -s $f ] || continue
    $checkpatch --file $f | fgrep -q "no obvious style problems" || echo "$f"
done
